{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %} {{ super() }} {{ channel.title}} {% endblock title %}

{% block head %} 
	{{ super() }}
{% endblock head %}

{% block header %}
    {{ super() }}
{% endblock header %}

{% block main %}
    <div class="container main">
    	<div class="row">
    		<div class="col-md-10 m-auto text-right p-3 channel-option-container">
    			<a href="{{url_for('main.home')}}" class="float-left btn btn-outline-secondary btn-sm"><i class="fas fa-long-arrow-alt-left"></i> Back</a>
    			<a class="btn btn-primary btn-sm main-add-button" href="{{ url_for('main.add_question', channel_key=channel.key)}}"><i class="fas fa-plus"></i> Add new question</a>
    			{% if questions %}    				
    				<button class="btn btn-primary btn-sm main-review-button" data-toggle="modal" data-target="#review-modal"><i class="fas fa-play"></i> Start a review</button>
    			{% else %}
    				<span class="d-inline-block" tabindex="0" data-placement="bottom" data-toggle="tooltip" title="Disabled. Please add questions.">
    					<button class="btn btn-primary btn-sm main-review-button"style="pointer-events: none;" type="button" disabled><i class="fas fa-play"></i> Start a review</button>
    				</span>
    			{% endif %}
    		</div>
    	</div>
    	<div class="row">
    		<div class="col-md-8 m-auto pb-2 pt-2">
    			<h4>{{ channel.title }}</h4>
    		</div>
    	</div>
    	<div class="row justify-content-center question-card-container">
			<div class="col-md-8">
				<div class="row justify-content-center">
		    		<div class="col-md-10">
		    			{% include 'includes/message_flash.html' %}
		    		</div>
		    	</div>
				<div class="">
    				{% if questions %}
    				    {% for question in questions %}
	    					<div class="card question-card">
			    				<div class="card-body">
			    					<div class="row d-flex">
			    						<div class="col-md-8 ml-2 mr-2" >
			    							<div class="card-text">
			    								<a class="m-0" data-toggle="collapse" href="#question-{{ question.id}}" role="button">{{ question.text }}</a>
			    							</div>
			    						</div>
			    						<div class="col-md-3 text-right">
			    							<!-- edit question -->
			    							<span class="d-none question-card-option" data-toggle="tooltip" data-placement="top" title="Edit">
			    								<a class="mr-2 question-edit" data-toggle="modal" data-target="#question-edit-modal" data-key='{{ question.key }}' data-option='edit'>
				    								<i class="fas fa-pencil-alt"></i>
				    							</a>
			    							</span>
			    							<!-- delete question -->
			    							<span class="d-none question-card-option" data-toggle="tooltip" data-placement="top" title="Delete">
				    							<a data-key='{{ question.key }}' class="delete-question mr-2">
				    								<i class="far fa-trash-alt"></i>
				    							</a>
			    							</span>

			    							<!-- favourite question -->
			    							{% if question.favourite %}
		    								    <span data-toggle="tooltip" data-placement="top" title="favourite">
					    							<a data-key='{{ question.key }}' class="favourite-question mr-2">
					    								<span class="favourite-icon">
					    								    <i class="fas fa-star"></i>
					    								</span>
					    							</a>
				    							</span>
		    								{% else %}
				    							<span class="d-none question-card-option" data-toggle="tooltip" data-placement="top" title="favourite">
					    							<a data-key='{{ question.key }}' class="favourite-question mr-2">
					    								<span class="favourite-icon">
					    								    <i class="far fa-star"></i>
					    								</span>
					    							</a>
				    							</span>
		    								{% endif %}
			    						</div>
			    					</div>
			    				</div>
			    				<div class="collapse" id="question-{{ question.id}}">
			    					<div class="card-footer">
										<div>
											{% if (question.answer_page) %}
											    <div class="small">
											    	<ul class="list-unstyled">
														<li>
															<dt>Answer page</dt>
															<ul>
																<li><p class="text-muted">{{ question.answer_page }}</p></li>
															</ul>
														</li>
													</ul>
												</div>
											{% endif %}
											{% if (question.answer_text) %}
											    <div class="small">
													<ul class="list-unstyled">
														<li>
															<dt>Answer description</dt>
															<ul>
																<li><p class="text-muted">{{ question.answer_text }}</p></li>
															</ul>
														</li>
													</ul>
												</div>
											{% endif %}
										</div>
									</div>
			    				</div>
			    				<a href="#"><span></span></a>
			    			</div>
	    				{% endfor %}
	    			{% else %}
	    			    <div class="card question-card">
		    				<div class="card-body">
		    					<div class="row justify-content-center">
		    						<div class="card-text ml-2">
		    							<p class="h4">No questions</p> 
		    						</div>
		    					</div>
		    				</div>
		    				<a href="#"><span></span></a>
		    			</div>
    				{% endif %}
    			</div>
    		</div>
    	</div>
    </div>

    <!-- review modal -->
    <div class="modal fade bd-example-modal-lg" id="review-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content bg-secondary">
	      <div class="modal-body">
	        <h5 class="modal-title" id="exampleModalLabel"></h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <i class="fas fa-times"></i>
	        </button>
	      </div>
	      <div class="modal-body text-light">
	        <div id="carouselExampleControls" class="carousel slide" data-interval="false">
			  <div class="carousel-inner text-center">
			  	{% if questions %}
			        {% for question in questions %}
			    		{% if loop.index == 1 %}
			    			<div class="carousel-item active">
			    		{% else %}
			    	    	<div class="carousel-item">
			    		{% endif %}
				      		<div class="card bg-secondary">
						    	<div class="card-body p-5">
						    		<p class="h5">{{ question.text }}</p>
						    	</div>
						    	<div class="card-footer pb-1 pt-1">
						    		<a class="btn btn-sm btn-link text-light view-answer" data-answer='{{ question.answer_text }}'><i class="far fa-eye"></i></a>
						    	</div>
						    </div>
				    	</div>
			    	{% endfor %}
			    {% endif %}
			  </div>
			  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
			    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
			    <span class="sr-only">Previous</span>
			  </a>
			  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
			    <span class="carousel-control-next-icon" aria-hidden="true"></span>
			    <span class="sr-only">Next</span>
			  </a>
			</div>
	      </div>
	      <div class="modal-body text-right">
	        <button type="button" class="btn btn-light" data-dismiss="modal">Close</button>
	        <button type="button" class="btn btn-primary" data-dismiss="modal">Done</button>
	      </div>
	    </div>
	  </div>
	</div>

	<!-- edit question -->
	<div class="modal" id="question-edit-modal" tabindex="-1" role="dialog">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content home-modal pt-3">
	      <div class="modal-body">
	      	<div class="container">

	      		<div class="question-modal-edit-content" class="d-none">
	      			<form method="POST" action="" id="question-edit-form">
	      				<input type="hidden" name="key" class="question-key-area">
		      			<div class="form-group">
		      				<label class="font-weight-bold">Question</label>
		      				<input type="text" name="question" class="form-control question-title-area" required>
		      			</div>
		      			<div class="form-group">
		      				<label class="font-weight-bold">Answer page</label>
		      				<input type="text" name="page" class="form-control question-page-area" />
		      			</div>
		      			<div class="form-group">
		      				<label class="font-weight-bold">Answer description</label>
		      				<textarea name="description" class="form-control question-description-area" rows="5"></textarea>
		      			</div>
		      		</form>
		      		<hr>
					<div class="float-right">
						<button type="button" class="btn btn-outline-dark" data-dismiss="modal">cancel</button>
						<button type="submit" class="btn btn-primary question-update-button" form="question-edit-form">update</button>
					</div>
	      		</div>

	      	</div>
	      </div>
	    </div>
	  </div>
	</div>

{% endblock main %}

{% block footer %}
    {{ super() }}
{% endblock footer %}

{% block scripts %}
    {{ super() }}
    <script type="text/javascript">
    	$('[data-toggle="tooltip"]').tooltip();
    </script>
{% endblock scripts %}